-- УДАЛЕНИЕ СТАРОГО МЕНЮ
local oldGui = game:GetService("CoreGui"):FindFirstChild("BlobmanMenu")
if oldGui then
    oldGui:Destroy()
end

-- СОЗДАНИЕ ГЛОБАЛЬНОЙ ПЕРЕМЕННОЙ ДЛЯ ОТСЛЕЖИВАНИЯ СОСТОЯНИЯ МЕНЮ
getgenv().BlobmanMenuOpen = true

-- ФУНКЦИЯ ДЛЯ СОЗДАНИЯ МЕНЮ
local function createMenu()
    -- СОЗДАНИЕ ОСНОВНОГО МЕНЮ
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "BlobmanMenu"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
    ScreenGui.Parent = game:GetService("CoreGui")

    -- ГЛАВНАЯ РАМКА
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 600, 0, 450)
    MainFrame.Position = UDim2.new(0.5, -300, 0.5, -225)
    MainFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.Parent = ScreenGui

    -- ЗАГОЛОВОК
    local TitleBar = Instance.new("Frame")
    TitleBar.Name = "TitleBar"
    TitleBar.Size = UDim2.new(1, 0, 0, 50)
    TitleBar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame

    local TitleText = Instance.new("TextLabel")
    TitleText.Name = "TitleText"
    TitleText.Size = UDim2.new(1, -20, 1, 0)
    TitleText.Position = UDim2.new(0, 10, 0, 0)
    TitleText.BackgroundTransparency = 1
    TitleText.Text = "Blobman Menu [G чтобы закрыть]"
    TitleText.TextColor3 = Color3.new(1, 1, 1)
    TitleText.TextSize = 24
    TitleText.Font = Enum.Font.GothamBold
    TitleText.TextXAlignment = Enum.TextXAlignment.Left
    TitleText.Parent = TitleBar

    -- ВКЛАДКИ
    local Tabs = Instance.new("Frame")
    Tabs.Name = "Tabs"
    Tabs.Size = UDim2.new(0, 150, 1, -50)
    Tabs.Position = UDim2.new(0, 0, 0, 50)
    Tabs.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Tabs.BorderSizePixel = 0
    Tabs.Parent = MainFrame

    -- СОДЕРЖИМОЕ
    local Content = Instance.new("Frame")
    Content.Name = "Content"
    Content.Size = UDim2.new(1, -150, 1, -50)
    Content.Position = UDim2.new(0, 150, 0, 50)
    Content.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    Content.BorderSizePixel = 0
    Content.Parent = MainFrame

    -- СПИСОК ДЛЯ КНОПОК ВКЛАДОК
    local TabList = Instance.new("UIListLayout")
    TabList.Name = "TabList"
    TabList.Padding = UDim.new(0, 2)  -- Отступ между кнопками
    TabList.FillDirection = Enum.FillDirection.Vertical
    TabList.SortOrder = Enum.SortOrder.LayoutOrder
    TabList.Parent = Tabs

    -- Хранение активных функций
    local ActiveFunctions = {}

    -- Хранение активных клавиш
    local ActiveKeybinds = {}

    -- ФУНКЦИЯ СОЗДАНИЯ ВКЛАДКИ
    local function createTab(name, order)
        local tabBtn = Instance.new("TextButton")
        tabBtn.Size = UDim2.new(1, 0, 0, 50)
        tabBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        tabBtn.Text = name
        tabBtn.TextColor3 = Color3.new(1, 1, 1)
        tabBtn.TextSize = 18  -- Конкретный размер шрифта вместо масштабирования
        tabBtn.Font = Enum.Font.GothamBold
        tabBtn.LayoutOrder = order
        tabBtn.Parent = Tabs

        local tabContent = Instance.new("ScrollingFrame")
        tabContent.Name = name .. "Tab"
        tabContent.Size = UDim2.new(1, -20, 1, -20)
        tabContent.Position = UDim2.new(0, 10, 0, 10)
        tabContent.BackgroundTransparency = 1
        tabContent.Visible = false
        tabContent.ScrollBarThickness = 6
        tabContent.BorderSizePixel = 0
        tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
        tabContent.AutomaticCanvasSize = Enum.AutomaticSize.Y
        tabContent.Parent = Content
        
        -- UIListLayout для элементов внутри вкладки
        local contentList = Instance.new("UIListLayout")
        contentList.Name = "ContentList"
        contentList.Padding = UDim.new(0, 10)
        contentList.FillDirection = Enum.FillDirection.Vertical
        contentList.SortOrder = Enum.SortOrder.LayoutOrder
        contentList.Parent = tabContent

        -- Автоматическое изменение размера контента
        local contentPadding = Instance.new("UIPadding")
        contentPadding.PaddingTop = UDim.new(0, 5)
        contentPadding.PaddingLeft = UDim.new(0, 5)
        contentPadding.PaddingRight = UDim.new(0, 5)
        contentPadding.PaddingBottom = UDim.new(0, 5)
        contentPadding.Parent = tabContent

        tabBtn.MouseButton1Click:Connect(function()
            -- Сброс цвета всех вкладок
            for _, btn in pairs(Tabs:GetChildren()) do
                if btn:IsA("TextButton") then
                    btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                end
            end
            
            -- Выделение активной вкладки
            tabBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            
            -- Скрыть все вкладки
            for _, v in pairs(Content:GetChildren()) do
                if v:IsA("ScrollingFrame") then
                    v.Visible = false
                end
            end
            -- Отобразить текущую вкладку
            tabContent.Visible = true
        end)

        return tabContent
    end

    -- Функция создания переключателя
    local function createToggle(parent, text, layoutOrder, callback)
        local toggleFrame = Instance.new("Frame")
        toggleFrame.Size = UDim2.new(1, 0, 0, 40)
        toggleFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        toggleFrame.BorderSizePixel = 0
        toggleFrame.LayoutOrder = layoutOrder
        toggleFrame.Parent = parent
        
        local toggleLabel = Instance.new("TextLabel")
        toggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
        toggleLabel.Position = UDim2.new(0, 10, 0, 0)
        toggleLabel.BackgroundTransparency = 1
        toggleLabel.Text = text
        toggleLabel.TextColor3 = Color3.new(1, 1, 1)
        toggleLabel.TextSize = 16
        toggleLabel.Font = Enum.Font.Gotham
        toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
        toggleLabel.Parent = toggleFrame
        
        local toggleButton = Instance.new("TextButton")
        toggleButton.Size = UDim2.new(0, 60, 0, 30)
        toggleButton.Position = UDim2.new(1, -70, 0.5, -15)
        toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
        toggleButton.Text = "OFF"
        toggleButton.TextColor3 = Color3.new(1, 1, 1)
        toggleButton.TextSize = 14
        toggleButton.Font = Enum.Font.GothamBold
        toggleButton.BorderSizePixel = 0
        toggleButton.Parent = toggleFrame
        
        local isToggled = false
        
        toggleButton.MouseButton1Click:Connect(function()
            isToggled = not isToggled
            
            if isToggled then
                toggleButton.BackgroundColor3 = Color3.fromRGB(60, 200, 60)
                toggleButton.Text = "ON"
                callback(true)
            else
                toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
                toggleButton.Text = "OFF"
                callback(false)
            end
        end)
        
        return toggleButton
    end

    -- Функция создания слайдера
    local function createSlider(parent, text, min, max, default, layoutOrder, callback)
        local sliderFrame = Instance.new("Frame")
        sliderFrame.Size = UDim2.new(1, 0, 0, 60)
        sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        sliderFrame.BorderSizePixel = 0
        sliderFrame.LayoutOrder = layoutOrder
        sliderFrame.Parent = parent
        
        local sliderLabel = Instance.new("TextLabel")
        sliderLabel.Size = UDim2.new(1, -20, 0, 20)
        sliderLabel.Position = UDim2.new(0, 10, 0, 5)
        sliderLabel.BackgroundTransparency = 1
        sliderLabel.Text = text .. ": " .. default
        sliderLabel.TextColor3 = Color3.new(1, 1, 1)
        sliderLabel.TextSize = 16
        sliderLabel.Font = Enum.Font.Gotham
        sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
        sliderLabel.Name = "SliderLabel"
        sliderLabel.Parent = sliderFrame
        
        local sliderBackground = Instance.new("Frame")
        sliderBackground.Size = UDim2.new(1, -20, 0, 10)
        sliderBackground.Position = UDim2.new(0, 10, 0, 30)
        sliderBackground.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        sliderBackground.BorderSizePixel = 0
        sliderBackground.Name = "SliderBackground"
        sliderBackground.Parent = sliderFrame
        
        local sliderFill = Instance.new("Frame")
        sliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
        sliderFill.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        sliderFill.BorderSizePixel = 0
        sliderFill.Name = "SliderFill"
        sliderFill.Parent = sliderBackground
        
        local sliderButton = Instance.new("TextButton")
        sliderButton.Size = UDim2.new(0, 20, 0, 20)
        sliderButton.Position = UDim2.new((default - min) / (max - min), -10, 0, -5)
        sliderButton.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        sliderButton.Text = ""
        sliderButton.BorderSizePixel = 0
        sliderButton.Name = "SliderButton"
        sliderButton.Parent = sliderBackground
        
        local currentValue = default
        
        -- Функция для обновления слайдера
        local function updateSlider(value)
            value = math.clamp(value, min, max)
            value = math.floor(value * 10 + 0.5) / 10 -- Округление до 1 знака после запятой
            
            local position = (value - min) / (max - min)
            sliderFill.Size = UDim2.new(position, 0, 1, 0)
            sliderButton.Position = UDim2.new(position, -10, 0, -5)
            sliderLabel.Text = text .. ": " .. value
            currentValue = value
            
            callback(value)
        end
        
        -- Обработка перетаскивания кнопки слайдера
        local dragging = false
        
        sliderButton.MouseButton1Down:Connect(function()
            dragging = true
        end)
        
        game:GetService("UserInputService").InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        game:GetService("UserInputService").InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local mousePosition = game:GetService("UserInputService"):GetMouseLocation()
                local sliderPosition = sliderBackground.AbsolutePosition
                local sliderSize = sliderBackground.AbsoluteSize
                
                local relativeX = math.clamp((mousePosition.X - sliderPosition.X) / sliderSize.X, 0, 1)
                local value = min + (max - min) * relativeX
                
                updateSlider(value)
            end
        end)
        
        -- Также разрешаем клик по фону слайдера
        sliderBackground.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                local mousePosition = game:GetService("UserInputService"):GetMouseLocation()
                local sliderPosition = sliderBackground.AbsolutePosition
                local sliderSize = sliderBackground.AbsoluteSize
                
                local relativeX = math.clamp((mousePosition.X - sliderPosition.X) / sliderSize.X, 0, 1)
                local value = min + (max - min) * relativeX
                
                updateSlider(value)
                dragging = true
            end
        end)
        
        -- Возвращаем объект слайдера и его текущее значение
        return {
            frame = sliderFrame,
            getValue = function() return currentValue end,
            setValue = function(value) updateSlider(value) end
        }
    end

    -- Функция создания информации о клавише
    local function createKeybindInfo(parent, text, key, layoutOrder)
        local keybindFrame = Instance.new("Frame")
        keybindFrame.Size = UDim2.new(1, 0, 0, 40)
        keybindFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        keybindFrame.BorderSizePixel = 0
        keybindFrame.LayoutOrder = layoutOrder
        keybindFrame.Parent = parent
        
        local keybindLabel = Instance.new("TextLabel")
        keybindLabel.Size = UDim2.new(0.7, 0, 1, 0)
        keybindLabel.Position = UDim2.new(0, 10, 0, 0)
        keybindLabel.BackgroundTransparency = 1
        keybindLabel.Text = text
        keybindLabel.TextColor3 = Color3.new(1, 1, 1)
        keybindLabel.TextSize = 16
        keybindLabel.Font = Enum.Font.Gotham
        keybindLabel.TextXAlignment = Enum.TextXAlignment.Left
        keybindLabel.Parent = keybindFrame
        
        local keyLabel = Instance.new("TextLabel")
        keyLabel.Size = UDim2.new(0, 60, 0, 30)
        keyLabel.Position = UDim2.new(1, -70, 0.5, -15)
        keyLabel.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        keyLabel.Text = key
        keyLabel.TextColor3 = Color3.new(1, 1, 1)
        keyLabel.TextSize = 14
        keyLabel.Font = Enum.Font.GothamBold
        keyLabel.BorderSizePixel = 0
        keyLabel.Parent = keybindFrame
        
        return keybindFrame
    end


    -- СОЗДАНИЕ ВКЛАДОК
    local defenceTab = createTab("Defence", 1)
    local playerTab = createTab("Player", 2)
    local teleportTab = createTab("Teleport", 3)
    local keybindsTab = createTab("Keybinds", 4)

    -- Пример добавления элементов на вкладку Defence
    local defenceTitle = Instance.new("TextLabel")
    defenceTitle.Size = UDim2.new(1, 0, 0, 30)
    defenceTitle.BackgroundTransparency = 1
    defenceTitle.Text = "Defence Options"
    defenceTitle.TextColor3 = Color3.new(1, 1, 1)
    defenceTitle.TextSize = 20
    defenceTitle.Font = Enum.Font.GothamBold
    defenceTitle.LayoutOrder = 1
    defenceTitle.Parent = defenceTab

    -- Добавляем заголовок на вкладку Player
    local playerTitle = Instance.new("TextLabel")
    playerTitle.Size = UDim2.new(1, 0, 0, 30)
    playerTitle.BackgroundTransparency = 1
    playerTitle.Text = "Player Options"
    playerTitle.TextColor3 = Color3.new(1, 1, 1)
    playerTitle.TextSize = 20
    playerTitle.Font = Enum.Font.GothamBold
    playerTitle.LayoutOrder = 1
    playerTitle.Parent = playerTab

    -- Добавляем заголовок на вкладку Keybinds
    local keybindsTitle = Instance.new("TextLabel")
    keybindsTitle.Size = UDim2.new(1, 0, 0, 30)
    keybindsTitle.BackgroundTransparency = 1
    keybindsTitle.Text = "Keybind Options"
    keybindsTitle.TextColor3 = Color3.new(1, 1, 1)
    keybindsTitle.TextSize = 20
    keybindsTitle.Font = Enum.Font.GothamBold
    keybindsTitle.LayoutOrder = 1
    keybindsTitle.Parent = keybindsTab

local function createAnchor()
    local originalModel = workspace:FindFirstChild("GrabParts")
    if not originalModel then return end

    -- Клонируем модель
    local cleanedModel = originalModel:Clone()
    cleanedModel.Name = "CleanedGrabParts"

    -- Очищаем клон от ненужного
    for _, v in ipairs(cleanedModel:GetDescendants()) do
        if v.Name == "GrabPart" or v.Name == "DragPart" then
            local soundsToRemove = {"AttachSound1", "AttachSound", "BeamSound", "BeamSound1"}
            for _, soundName in ipairs(soundsToRemove) do
                local sound = v:FindFirstChild(soundName)
                if sound then
                    sound:Destroy()
                end
            end
            v.Transparency = 1

        elseif v.Name == "BeamPart" then
            local grabBeam = v:FindFirstChild("GrabBeam")
            if grabBeam then
                grabBeam:Destroy()
            end
        end
    end

    -- Помещаем очищенный клон в workspace
    cleanedModel.Parent = workspace
end

-- Создаем вкладку "Other"
local otherTab = createTab("Other", 5)  -- Создаем вкладку "Other" с порядковым номером 5

-- Функция для создания переключателя коллизии воды
local function setupWaterCollision()
    -- Создаем переключатель для коллизии воды
    local waterCollisionToggle = createToggle(otherTab, "Water Collision", 2, function(enabled)
        if enabled then
            -- Включение коллизии
            local parentModel = workspace:FindFirstChild("Map")
                and workspace.Map:FindFirstChild("AlwaysHereTweenedObjects")
                and workspace.Map.AlwaysHereTweenedObjects:FindFirstChild("Ocean")
                and workspace.Map.AlwaysHereTweenedObjects.Ocean:FindFirstChild("Object")
                and workspace.Map.AlwaysHereTweenedObjects.Ocean.Object:FindFirstChild("ObjectModel")

            if parentModel then
                for _, child in ipairs(parentModel:GetChildren()) do
                    if child.Name == "Ocean" and child:IsA("BasePart") then
                        child.CanCollide = true  -- Включаем коллизию
                    end
                end
            end
        else
            -- Выключение коллизии
            local parentModel = workspace:FindFirstChild("Map")
                and workspace.Map:FindFirstChild("AlwaysHereTweenedObjects")
                and workspace.Map.AlwaysHereTweenedObjects:FindFirstChild("Ocean")
                and workspace.Map.AlwaysHereTweenedObjects.Ocean:FindFirstChild("Object")
                and workspace.Map.AlwaysHereTweenedObjects.Ocean.Object:FindFirstChild("ObjectModel")

            if parentModel then
                for _, child in ipairs(parentModel:GetChildren()) do
                    if child.Name == "Ocean" and child:IsA("BasePart") then
                        child.CanCollide = false  -- Выключаем коллизию
                    end
                end
            end
        end
    end)

    -- Добавляем информационный текст для коллизии воды
    local waterCollisionInfo = Instance.new("TextLabel")
    waterCollisionInfo.Size = UDim2.new(1, -20, 0, 40)
    waterCollisionInfo.BackgroundTransparency = 1
    waterCollisionInfo.Text = "Toggles the water collision state. Disable to pass through the water."
    waterCollisionInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
    waterCollisionInfo.TextSize = 14
    waterCollisionInfo.Font = Enum.Font.Gotham
    waterCollisionInfo.TextWrapped = true
    waterCollisionInfo.LayoutOrder = 3
    waterCollisionInfo.Parent = otherTab
end

    -- Добавляем AntiGrab на вкладку Defence
    local function setupAntiGrab()
        -- Создаем переключатель AntiGrab
        local antiGrabToggle = createToggle(defenceTab, "Anti Grab", 2, function(enabled)
            if enabled then
                -- Создание функции AntiGrab и сохранение ее для возможности остановки
                ActiveFunctions.AntiGrab = true
                
                spawn(function()
                    -- Петля, которая выполняется, пока функция активна
                    while ActiveFunctions.AntiGrab do
                        pcall(function()
                            game:GetService("ReplicatedStorage"):WaitForChild("CharacterEvents"):WaitForChild("Struggle"):FireServer()
                        end)
                        wait(0) -- Небольшая задержка для уменьшения нагрузки
                    end
                end)
            else
                -- Отключение функции
                ActiveFunctions.AntiGrab = false
            end
        end)
        
        -- Добавляем информационный текст
        local antiGrabInfo = Instance.new("TextLabel")
        antiGrabInfo.Size = UDim2.new(1, -20, 0, 40)
        antiGrabInfo.BackgroundTransparency = 1
        antiGrabInfo.Text = "Prevents other players from grabbing you by constantly calling the Struggle function"
        antiGrabInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        antiGrabInfo.TextSize = 14
        antiGrabInfo.Font = Enum.Font.Gotham
        antiGrabInfo.TextWrapped = true
        antiGrabInfo.LayoutOrder = 3
        antiGrabInfo.Parent = defenceTab
    end

    -- Функция для настройки скорости игрока
    local function setupPlayerSpeed()
        -- Создаем слайдер для изменения скорости
        local speedSlider = createSlider(playerTab, "Walk Speed", 16, 100, 16, 2, function(value)
            -- Изменяем скорость игрока
            local player = game.Players.LocalPlayer
            local character = player.Character or player.CharacterAdded:Wait()
            local humanoid = character:FindFirstChild("Humanoid")
            
            if humanoid then
                humanoid.WalkSpeed = value
            end
        end)
        
        -- Добавляем информационный текст
        local speedInfo = Instance.new("TextLabel")
        speedInfo.Size = UDim2.new(1, -20, 0, 30)
        speedInfo.BackgroundTransparency = 1
        speedInfo.Text = "Changes your character's walking speed (default is 16)"
        speedInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        speedInfo.TextSize = 14
        speedInfo.Font = Enum.Font.Gotham
        speedInfo.TextWrapped = true
        speedInfo.LayoutOrder = 3
        speedInfo.Parent = playerTab
        
        -- Создаем переключатель для активации/деактивации постоянной скорости
        local keepSpeedToggle = createToggle(playerTab, "Keep Speed On Respawn", 4, function(enabled)
            if enabled then
                ActiveFunctions.KeepSpeed = true
                
                -- Сохраняем текущую скорость
                local currentSpeed = speedSlider.getValue()
                
                -- Функция для применения скорости при появлении персонажа
                local function onCharacterAdded(character)
                    if not ActiveFunctions.KeepSpeed then return end
                    
                    local humanoid = character:WaitForChild("Humanoid")
                    humanoid.WalkSpeed = currentSpeed
                end
                
                -- Соединяем с событием создания персонажа
                game.Players.LocalPlayer.CharacterAdded:Connect(onCharacterAdded)
            else
                ActiveFunctions.KeepSpeed = false
            end
        end)
    end

    -- Функция для настройки бесконечного прыжка
    local function setupInfiniteJump()
        -- Создаем переключатель для бесконечного прыжка
        local infiniteJumpToggle = createToggle(playerTab, "Infinite Jump", 5, function(enabled)
            if enabled then
                ActiveFunctions.InfiniteJump = true
            else
                ActiveFunctions.InfiniteJump = false
            end
        end)
        
        -- Добавляем информационный текст
        local jumpInfo = Instance.new("TextLabel")
        jumpInfo.Size = UDim2.new(1, -20, 0, 40)
        jumpInfo.BackgroundTransparency = 1
        jumpInfo.Text = "Allows you to jump infinitely by holding the spacebar"
        jumpInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        jumpInfo.TextSize = 14
        jumpInfo.Font = Enum.Font.Gotham
        jumpInfo.TextWrapped = true
        jumpInfo.LayoutOrder = 6
        jumpInfo.Parent = playerTab
        
        -- Создаем слайдер для изменения силы прыжка
        local jumpPowerSlider = createSlider(playerTab, "Jump Power", 50, 200, 50, 7, function(value)
            -- Изменяем силу прыжка игрока
            local player = game.Players.LocalPlayer
            local character = player.Character or player.CharacterAdded:Wait()
            local humanoid = character:FindFirstChild("Humanoid")
            
            if humanoid then
                humanoid.JumpPower = value
            end
        end)
        
        -- Добавляем информационный текст для силы прыжка
        local jumpPowerInfo = Instance.new("TextLabel")
        jumpPowerInfo.Size = UDim2.new(1, -20, 0, 30)
        jumpPowerInfo.BackgroundTransparency = 1
        jumpPowerInfo.Text = "Changes your character's jump height (default is 50)"
        jumpPowerInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        jumpPowerInfo.TextSize = 14
        jumpPowerInfo.Font = Enum.Font.Gotham
        jumpPowerInfo.TextWrapped = true
        jumpPowerInfo.LayoutOrder = 8
        jumpPowerInfo.Parent = playerTab
    end

    -- Функция спавна паллета перед игроком
    local function spawnPallet()
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        
        -- Получаем текущую позицию и направление персонажа
        local currentPosition = humanoidRootPart.Position
        local lookVector = humanoidRootPart.CFrame.LookVector
        
        -- Создаем позицию перед игроком (2 единицы вперед вместо 5)
        local targetPosition = currentPosition + (lookVector * 2)
        
        -- Создаем CFrame смотрящий в ту же сторону, что и игрок
        local targetCFrame = CFrame.new(targetPosition, targetPosition + lookVector)
        
        -- Добавляем небольшой отступ вверх, чтобы паллет не застрял в земле
        targetCFrame = targetCFrame * CFrame.new(0, 0.5, 0)
        
        -- Вызываем функцию спавна паллета
        pcall(function()
            local args = {
                [1] = "PalletLightBrown",
                [2] = targetCFrame,
                [3] = Vector3.new(0, 31.239999771118164, 0)
            }
            game:GetService("ReplicatedStorage"):WaitForChild("MenuToys"):WaitForChild("SpawnToyRemoteFunction"):InvokeServer(unpack(args))
        end)
    end

    -- Добавляем функцию спавна паллета на клавишу Tab
    local function setupPalletKeybind()
        -- Создаем информацию о клавише
        local palletKeybindInfo = createKeybindInfo(keybindsTab, "Spawn Pallet", "Tab", 2)
        
        -- Добавляем информационный текст
        local palletInfo = Instance.new("TextLabel")
        palletInfo.Size = UDim2.new(1, -20, 0, 40)
        palletInfo.BackgroundTransparency = 1
        palletInfo.Text = "Press Tab to spawn a pallet directly in front of you"
        palletInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        palletInfo.TextSize = 14
        palletInfo.Font = Enum.Font.Gotham
        palletInfo.TextWrapped = true
        palletInfo.LayoutOrder = 3
        palletInfo.Parent = keybindsTab
        
        -- Создаем переключатель для активации/деактивации клавиши
        local palletKeybindToggle = createToggle(keybindsTab, "Enable Pallet Keybind", 4, function(enabled)
            if enabled then
                ActiveKeybinds.PalletSpawn = true
            else
                ActiveKeybinds.PalletSpawn = false
            end
        end)
    end

    -- Кнопка удаления GrabPart и DragPart из модели GrabParts
local clearGrabPartsButton = Instance.new("TextButton")
clearGrabPartsButton.Size = UDim2.new(1, -20, 0, 40)
clearGrabPartsButton.Position = UDim2.new(0, 10, 0, 0)
clearGrabPartsButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
clearGrabPartsButton.Text = "Delete Anchor"
clearGrabPartsButton.TextColor3 = Color3.new(1, 1, 1)
clearGrabPartsButton.TextSize = 16
clearGrabPartsButton.Font = Enum.Font.GothamBold
clearGrabPartsButton.BorderSizePixel = 0
clearGrabPartsButton.LayoutOrder = 5
clearGrabPartsButton.Parent = keybindsTab

clearGrabPartsButton.MouseButton1Click:Connect(function()
    local model = workspace:FindFirstChild("CleanedGrabParts")
    if model then
        model:Destroy()
    end
end)

    -- Функция телепортации к точке, на которую указывает мышь
    local function teleportToMousePosition()
        local player = game.Players.LocalPlayer
        local mouse = player:GetMouse()
        local character = player.Character
        local humanoid = character and character:FindFirstChild("Humanoid")
        local humanoidRootPart = character and character:FindFirstChild("HumanoidRootPart")
        
        if humanoidRootPart and humanoid and humanoid.Health > 0 then
            -- Проверяем позицию, куда указывает мышь
            local targetPosition = mouse.Hit.Position
            
            -- Телепортируем игрока на эту позицию (с небольшим смещением вверх, чтобы не застрять в земле)
            humanoidRootPart.CFrame = CFrame.new(targetPosition) * CFrame.new(0, 3, 0)
        end
    end

  -- Добавляем функцию телепортации на вкладку Teleport
    local function setupTeleportTab()
        -- Добавляем заголовок на вкладку Teleport
        local teleportTitle = Instance.new("TextLabel")
        teleportTitle.Size = UDim2.new(1, 0, 0, 30)
        teleportTitle.BackgroundTransparency = 1
        teleportTitle.Text = "Teleport Options"
        teleportTitle.TextColor3 = Color3.new(1, 1, 1)
        teleportTitle.TextSize = 20
        teleportTitle.Font = Enum.Font.GothamBold
        teleportTitle.LayoutOrder = 1
        teleportTitle.Parent = teleportTab
        
        -- Создаем информацию о клавише телепорта
        local teleportKeybindInfo = createKeybindInfo(teleportTab, "Click Teleport", "T", 2)
        
        -- Добавляем информационный текст
        local teleportInfo = Instance.new("TextLabel")
        teleportInfo.Size = UDim2.new(1, -20, 0, 40)
        teleportInfo.BackgroundTransparency = 1
        teleportInfo.Text = "Press T to teleport to the position where your mouse is pointing"
        teleportInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        teleportInfo.TextSize = 14
        teleportInfo.Font = Enum.Font.Gotham
        teleportInfo.TextWrapped = true
        teleportInfo.LayoutOrder = 3
        teleportInfo.Parent = teleportTab
        
        -- Создаем переключатель для активации/деактивации телепорта
        local teleportToggle = createToggle(teleportTab, "Enable Click Teleport", 4, function(enabled)
            if enabled then
                ActiveKeybinds.ClickTeleport = true
            else
                ActiveKeybinds.ClickTeleport = false
            end
        end)
        
        -- Добавляем кнопку телепорта к случайному игроку
        local randomTeleportButton = Instance.new("TextButton")
        randomTeleportButton.Size = UDim2.new(1, -20, 0, 40)
        randomTeleportButton.Position = UDim2.new(0, 10, 0, 0)
        randomTeleportButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        randomTeleportButton.Text = "Teleport to Random Player"
        randomTeleportButton.TextColor3 = Color3.new(1, 1, 1)
        randomTeleportButton.TextSize = 16
        randomTeleportButton.Font = Enum.Font.GothamBold
        randomTeleportButton.BorderSizePixel = 0
        randomTeleportButton.LayoutOrder = 5
        randomTeleportButton.Parent = teleportTab
        
        randomTeleportButton.MouseButton1Click:Connect(function()
            local players = game:GetService("Players"):GetPlayers()
            local localPlayer = game.Players.LocalPlayer
            local validPlayers = {}
            
            -- Находим всех игроков, кроме локального
            for _, player in pairs(players) do
                if player ~= localPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    table.insert(validPlayers, player)
                end
            end
            
            -- Если есть доступные игроки, телепортируемся к случайному
            if #validPlayers > 0 then
                local randomPlayer = validPlayers[math.random(1, #validPlayers)]
                local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                
                if humanoidRootPart and randomPlayer.Character and randomPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    humanoidRootPart.CFrame = randomPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                end
            end
        end)
        
        -- Добавляем телепорт к точкам спавна
        local spawnTeleportButton = Instance.new("TextButton")
        spawnTeleportButton.Size = UDim2.new(1, -20, 0, 40)
        spawnTeleportButton.Position = UDim2.new(0, 10, 0, 0)
        spawnTeleportButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        spawnTeleportButton.Text = "Teleport to Spawn"
        spawnTeleportButton.TextColor3 = Color3.new(1, 1, 1)
        spawnTeleportButton.TextSize = 16
        spawnTeleportButton.Font = Enum.Font.GothamBold
        spawnTeleportButton.BorderSizePixel = 0
        spawnTeleportButton.LayoutOrder = 6
        spawnTeleportButton.Parent = teleportTab
        
        spawnTeleportButton.MouseButton1Click:Connect(function()
            local player = game.Players.LocalPlayer
            local character = player.Character or player.CharacterAdded:Wait()
            
            -- Находим точки спавна
            local spawnLocations = workspace:FindFirstChild("SpawnLocations")
            if spawnLocations and #spawnLocations:GetChildren() > 0 then
                local spawnPoint = spawnLocations:GetChildren()[math.random(1, #spawnLocations:GetChildren())]
                character:SetPrimaryPartCFrame(spawnPoint.CFrame * CFrame.new(0, 3, 0))
            else
                -- Если не нашли специальные точки спавна, используем стандартное место спавна
                player:LoadCharacter()
            end
        end)
    end
    
    -- Функция для добавления NoClip (прохождение сквозь стены)
    local function setupNoClip()
        -- Создаем переключатель для включения NoClip
        local noClipToggle = createToggle(playerTab, "No Clip", 9, function(enabled)
            if enabled then
                ActiveFunctions.NoClip = true
                
                -- Запускаем петлю для NoClip
                spawn(function()
                    while ActiveFunctions.NoClip do
                        local player = game.Players.LocalPlayer
                        local character = player.Character
                        
                        if character then
                            for _, part in pairs(character:GetDescendants()) do
                                if part:IsA("BasePart") then
                                    part.CanCollide = false
                                end
                            end
                        end
                        
                        wait(0.1) -- Проверяем каждую 1/10 секунды
                    end
                end)
            else
                ActiveFunctions.NoClip = false
                
                -- Восстанавливаем обычную коллизию
                local player = game.Players.LocalPlayer
                local character = player.Character
                
                if character then
                    for _, part in pairs(character:GetDescendants()) do
                        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                            part.CanCollide = true
                        end
                    end
                end
            end
        end)
        
        -- Добавляем информационный текст
        local noClipInfo = Instance.new("TextLabel")
        noClipInfo.Size = UDim2.new(1, -20, 0, 40)
        noClipInfo.BackgroundTransparency = 1
        noClipInfo.Text = "Allows you to walk through walls and objects"
        noClipInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
        noClipInfo.TextSize = 14
        noClipInfo.Font = Enum.Font.Gotham
        noClipInfo.TextWrapped = true
        noClipInfo.LayoutOrder = 10
        noClipInfo.Parent = playerTab
    end
    
-- Функция обработки нажатия клавиш
local function setupKeyBindings()
    -- Создаем подключение к событию нажатия клавиш
    game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
        -- Не обрабатываем, если игра уже обработала ввод (например, в чате)
        if gameProcessed then return end
        
        -- Обработка клавиши G для закрытия/открытия меню
        if input.KeyCode == Enum.KeyCode.G then
            getgenv().BlobmanMenuOpen = not getgenv().BlobmanMenuOpen
            ScreenGui.Enabled = getgenv().BlobmanMenuOpen
        end
        
        -- Обработка клавиши Tab для спавна паллета
        if input.KeyCode == Enum.KeyCode.Tab and ActiveKeybinds.PalletSpawn then
            spawnPallet()
        end
        
        -- Обработка клавиши T для телепортации
        if input.KeyCode == Enum.KeyCode.T and ActiveKeybinds.ClickTeleport then
            teleportToMousePosition()
        end
        
        -- Обработка клавиши K для создания якоря
        if input.KeyCode == Enum.KeyCode.K and ActiveKeybinds.AnchorGrabParts then
            createAnchor()
        end
        
        -- Обработка пробела для бесконечных прыжков
        if input.KeyCode == Enum.KeyCode.Space and ActiveFunctions.InfiniteJump then
            local player = game.Players.LocalPlayer
            local character = player.Character
            
            if character and character:FindFirstChild("Humanoid") then
                character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end)
end
    -- Функция для создания и настройки якоря (anchor)
local function setupAnchorKeybind()
    -- Создаем информацию о клавише
    local anchorKeybindInfo = createKeybindInfo(keybindsTab, "Duplicate GrabParts", "K", 7)
    
    -- Добавляем информационный текст
    local anchorInfo = Instance.new("TextLabel")
    anchorInfo.Size = UDim2.new(1, -20, 0, 40)
    anchorInfo.BackgroundTransparency = 1
    anchorInfo.Text = "Press K to duplicate GrabParts and remove sounds"
    anchorInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
    anchorInfo.TextSize = 14
    anchorInfo.Font = Enum.Font.Gotham
    anchorInfo.TextWrapped = true
    anchorInfo.LayoutOrder = 8
    anchorInfo.Parent = keybindsTab
    
    -- Создаем переключатель для активации/деактивации клавиши
    local anchorKeybindToggle = createToggle(keybindsTab, "Enable Anchor Keybind", 9, function(enabled)
        if enabled then
            ActiveKeybinds.AnchorGrabParts = true
        else
            ActiveKeybinds.AnchorGrabParts = false
        end
    end)
end

    -- Вызываем все функции настройки
    setupAntiGrab()
    setupPlayerSpeed()
    setupInfiniteJump()
    setupNoClip()
    setupTeleportTab()
    setupPalletKeybind()
    setupAnchorKeybind()
    setupWaterCollision()
    setupKeyBindings()
    
    -- Устанавливаем первую вкладку как активную по умолчанию
    for _, btn in pairs(Tabs:GetChildren()) do
        if btn:IsA("TextButton") then
            btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            if btn.Text == "Defence" then
                btn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            end
        end
    end
    
    for _, v in pairs(Content:GetChildren()) do
        if v:IsA("ScrollingFrame") then
            v.Visible = false
            if v.Name == "DefenceTab" then
                v.Visible = true
            end
        end
    end
    
    return ScreenGui
end

-- СОЗДАНИЕ МЕНЮ
local menu = createMenu()

-- ОБРАБОТКА ЗАКРЫТИЯ СКРИПТА
game:GetService("CoreGui").ChildRemoved:Connect(function(child)
    if child.Name == "BlobmanMenu" then
        getgenv().BlobmanMenuOpen = false
    end
end)

-- ВЫВОД В КОНСОЛЬ О УСПЕШНОЙ ЗАГРУЗКЕ
print("Blobman Menu Successfully Loaded! Press G to toggle menu.")
